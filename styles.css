:root {
  /* Traditional Ocean Background (Deep Blue for contrast, but ocean-like) */
  --bg-deep: #004866; /* Matched to Globe */ 
  /* Traditional Borders (Solid Black for Safari) */
  --map-stroke: #000000; 
  
  --neon-blue: #00f3ff;
  --neon-pink: #ff0055;
  --neon-green: #00ff9d;
  --neon-amber: #ffaa00;
  --glass: rgba(15, 15, 15, 0.85);
  --font-main: "Segoe UI", Roboto, Helvetica, Arial, sans-serif;

  /* Traditional Continent Colors from Globe */
  --c-na: #e6c288; /* Sandy/Yellow */
  --c-sa: #a8c686; /* Muted Green */
  --c-eu: #d8a499; /* Muted Pink/Red */
  --c-af: #e8d8a5; /* Desert Yellow */
  --c-as: #c4a484; /* Earthy Brown */
  --c-oc: #99badd; /* Light Blue/Teal */
  
  color-scheme: dark; /* Hint to browser to use dark UA styles */
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  background-color: var(--bg-deep);
  color: white;
  font-family: var(--font-main);
  overflow: hidden;
  height: 100vh;
  width: 100vw;
  user-select: none;
  touch-action: none;
}

.hidden {
  display: none !important;
}

#map-stage {
  width: 100%;
  height: 100%;
  cursor: crosshair;
  touch-action: none; /* Critical for mobile drag */
}

.state {
  stroke: var(--map-stroke);
  stroke-width: 0.5px;
  stroke-opacity: 1;
  transition:
    fill 0.3s,
    opacity 0.3s,
    filter 0.3s,
    stroke 0.3s;
  vector-effect: non-scaling-stroke;
  fill: rgba(120, 180, 220, 0.4);
}

.state[data-continent="north-america"] {
  fill: var(--c-na);
}
.state[data-continent="south-america"] {
  fill: var(--c-sa);
}
.state[data-continent="europe"] {
  fill: var(--c-eu);
}
.state[data-continent="africa"] {
  fill: var(--c-af);
}
.state[data-continent="asia"] {
  fill: var(--c-as);
}
.state[data-continent="oceania"] {
  fill: var(--c-oc);
}

/* Darker variants for Zoomed/Active State (Safari-safe) */
.state.active-focused[data-continent="north-america"] { fill: #8A7451; }
.state.active-focused[data-continent="south-america"] { fill: #657750; }
.state.active-focused[data-continent="europe"]        { fill: #82625C; }
.state.active-focused[data-continent="africa"]        { fill: #8B8263; }
.state.active-focused[data-continent="asia"]          { fill: #76624F; }
.state.active-focused[data-continent="oceania"]       { fill: #5C7085; }

.state:hover {
  opacity: 0.9;
  stroke: #000000; /* Force black on hover */
  stroke-width: 1px; /* "Full thickness" */
  filter: brightness(0.8); /* Darken on hover */
}
/* Active/Zoomed State */
.state.active-focused {
  opacity: 1;
  stroke: #000000; /* Force Black */
  stroke-width: 1px; /* Full Thickness */
  /* Filter removed -> replaced by explicit fill changes above */
}

.country.highlight {
  opacity: 1;
  stroke: #000000;
  stroke-width: 1px;
}

/* Animation */
.state.correct-flash {
  animation: flashSuccess 0.5s forwards;
}
.state.wrong-flash {
  animation: flashError 0.5s forwards;
}
@keyframes flashSuccess {
  0% {
    fill: var(--neon-green);
    opacity: 1;
  }
  100% {
    fill: inherit;
    opacity: 1;
  }
}
@keyframes flashError {
  0% {
    fill: var(--neon-pink); /* Red-Pink for error */
    opacity: 1;
  }
  100% {
    fill: inherit;
    opacity: 1;
  }
  100% {
    fill: inherit;
    opacity: 1;
  }
}

.city-halo {
  fill: none;
  stroke: var(--neon-blue);
  stroke-width: 2px; /* Thicker start */
  vector-effect: non-scaling-stroke;
  opacity: 0.8;
  animation: pulseHalo 1.5s infinite ease-in-out; /* Faster, smooth throb */
}

@keyframes pulseHalo {
  0% {
    transform: scale(1);
    opacity: 0.8;
    stroke-width: 2px;
  }
  50% {
    transform: scale(2); /* Expand to 2x */
    opacity: 0.4;
    stroke-width: 1px;
  }
  100% {
    transform: scale(1); /* Return to start */
    opacity: 0.8;
    stroke-width: 2px;
  }
}
/* Ensure origin is center for scaling */
.city-halo { transform-box: fill-box; transform-origin: center; }

.city-node {
  fill: var(--neon-blue);
  stroke: rgba(0, 243, 255, 0.2);
  stroke-width: 0.5px;
  vector-effect: non-scaling-stroke;
  cursor: pointer;
  pointer-events: none;
}
.city-node:hover {
  fill: #fff;
  stroke: var(--neon-blue);
  stroke-width: 2px;
}
.city-node.wrong-choice {
  fill: var(--neon-pink);
  stroke: var(--neon-pink);
  pointer-events: none;
  opacity: 0.6;
  animation: none;
}
.city-node.correct-choice {
  fill: var(--neon-green);
  stroke: var(--neon-green);
  animation: none;
}



#ui-layer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
}

/* Wrapper for HUD and Back Button to ensure vertical centering */
#top-bar {
  position: absolute;
  top: 40px;
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  pointer-events: none;
  z-index: 10;
}

#top-hud {
  /* Removed absolute positioning */
  position: relative;
  /* Removed top/left/transform */
  background: var(--glass);
  border: 1px solid rgba(255, 255, 255, 0.1);
  padding: 10px 30px;
  border-radius: 50px;
  display: flex;
  gap: 40px;
  backdrop-filter: blur(15px);
  pointer-events: auto;
}

/* Back Button */
.back-btn {
  position: absolute;
  left: 40px;
  /* Vertically center within #top-bar */
  top: 50%;
  transform: translateY(-50%);
  width: 44px;
  height: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--glass);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 50%;
  color: white;
  text-decoration: none;
  backdrop-filter: blur(15px);
  z-index: 20;
  transition: 0.3s;
  pointer-events: auto;
}
.back-btn:hover {
  background: white;
  color: black;
  /* Include translateY in hover transform to maintain position */
  transform: translateY(-50%) scale(1.1);
}
.hud-group {
  display: flex;
  flex-direction: column;
  align-items: center;
  min-width: 70px;
}
.hud-item {
  font-size: 0.7rem;
  color: rgba(255, 255, 255, 0.5);
  text-transform: uppercase;
  letter-spacing: 1.5px;
}
.hud-val {
  color: var(--neon-blue);
  font-weight: 800;
  font-size: 1.2rem;
}

.toggle-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  cursor: pointer;
  min-width: 80px; /* Ensure container doesn't shrink */
}
#mode-label {
  display: inline-block;
  width: 60px; /* Fixed width to hold 'Capital' without resizing */
  text-align: center;
}
.toggle-switch {
  width: 40px;
  height: 20px;
  background: #333;
  border-radius: 20px;
  position: relative;
  transition: 0.3s;
  border: 1px solid #444;
}
.toggle-knob {
  width: 16px;
  height: 16px;
  background: white;
  border-radius: 50%;
  position: absolute;
  top: 1px;
  left: 2px;
  transition: 0.3s;
}
.active .toggle-switch {
  background: var(--neon-blue);
}
.active .toggle-knob { left: 21px; }

.toggle-container.disabled {
  opacity: 0.5;
  pointer-events: none;
  filter: grayscale(1);
  cursor: not-allowed;
}

#prompt-container {
  position: absolute;
  top: 100px;
  width: 100%;
  text-align: center;
  text-shadow: 0 5px 25px black;
}

/* Force tighter desktop positioning explicitly */
@media (min-width: 769px) {
  #prompt-container {
    top: 90px; /* Extremely tight to HUD (Bottom 90px) */
    padding-top: 5px; /* Slight push to prevent text clipping */
    z-index: 5;
  }
}
#find-label {
  font-size: 1.2rem;
  text-transform: uppercase;
  color: #888;
  letter-spacing: 4px;
  margin: 0;
}
#main-prompt {
  font-size: 2rem;
  font-weight: 900;
  margin: 5px 0 0;
}
#sub-prompt {
  font-size: 1.1rem;
  color: #000000; /* Black Text */
  background-color: #ffffff; /* White Background */
  display: inline-block;
  padding: 8px 24px;
  border-radius: 50px; /* Pill shape */
  box-shadow: 0 4px 15px rgba(0,0,0,0.5);
  margin-top: 15px;
  font-weight: 600;
  opacity: 0; /* Hidden by default */
  visibility: hidden; /* Ensure it's ignored by clicks too */
  transition: opacity 0.3s, visibility 0.3s;
}

#sub-prompt.show, #sub-prompt.persist {
  opacity: 1 !important;
  visibility: visible !important;
}

#sub-prompt:empty {
  display: none !important;
  padding: 0 !important;
  opacity: 0 !important;
  visibility: hidden !important;
}

#fact-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.95);
  z-index: 100;
  display: flex;
  justify-content: center;
  align-items: center;
  opacity: 0;
  pointer-events: none;
  transition: opacity 0.3s;
}
#fact-overlay.show {
  opacity: 1;
  pointer-events: auto;
}
.fact-card {
  background: #111;
  border: 2px solid var(--neon-blue);
  border-radius: 20px;
  padding: 45px;
  max-width: 500px;
  width: 90%;
  text-align: center;
}
.fact-status {
  font-weight: 800;
  letter-spacing: 4px;
  margin-bottom: 12px;
  font-size: 1.1rem;
  text-transform: uppercase;
}
.status-correct {
  color: var(--neon-green);
}
.status-wrong {
  color: var(--neon-pink);
}
.fact-city {
  font-size: 2.2rem;
  margin: 0 0 15px;
  color: white;
  font-weight: 900;
}
.fact-body {
  color: #ddd;
  line-height: 1.7;
  margin-bottom: 35px;
  font-size: 1.1rem;
}
.next-btn {
  background: var(--neon-blue);
  color: #000;
  border: none;
  padding: 16px 45px;
  font-weight: 800;
  border-radius: 40px;
  cursor: pointer;
  text-transform: uppercase;
}

#city-tooltip {
  position: absolute;
  background: black;
  border: 1px solid var(--neon-blue);
  color: white;
  padding: 4px 8px;
  font-size: 12px;
  pointer-events: none;
  opacity: 0;
  z-index: 50;
}

/* Landing page */
.landing {
  overflow: hidden;
  background:
    radial-gradient(
      1200px 600px at 50% -10%,
      rgba(0, 243, 255, 0.12),
      transparent 60%
    ),
    linear-gradient(180deg, #050505, #0c0c0c);
}

.landing-shell {
  min-height: 100vh;
  display: grid;
  grid-template-rows: auto 1fr;
  gap: 10px;
  padding: 24px 28px 28px;
  position: relative;
}

.landing-header {
  text-align: center;
}
.landing-title {
  font-size: clamp(2.3rem, 4vw, 3.5rem);
  margin: 0;
}

.map-stage {
  width: 100%;
  height: calc(100vh - 120px);
  min-height: 420px;
  position: relative;
}

.world-svg {
  display: block;
  width: 100%;
  height: 100%;
}

.country {
  fill: #d0d0d0; /* Default Grey/Paper color */
  stroke: var(--map-stroke);
  stroke-width: 0.5px;
  stroke-opacity: 1;
  transition:
    fill 0.2s,
    opacity 0.2s,
    stroke 0.2s;
}

.country.dim {
  opacity: 0.15;
}

.country.highlight {
  opacity: 1;
  stroke: #000000;
  stroke-width: 1px;
}

.country.highlight[data-continent="north-america"] {
  fill: var(--c-na);
}
.country.highlight[data-continent="south-america"] {
  fill: var(--c-sa);
}
.country.highlight[data-continent="europe"] {
  fill: var(--c-eu);
}
.country.highlight[data-continent="africa"] {
  fill: var(--c-af);
}
.country.highlight[data-continent="asia"] {
  fill: var(--c-as);
}
.country.highlight[data-continent="oceania"] {
  fill: var(--c-oc);
}

.map-tooltip {
  position: absolute;
  background: #0b0b0b;
  border: 1px solid rgba(255, 255, 255, 0.2);
  color: white;
  padding: 6px 10px;
  font-size: 13px;
  border-radius: 10px;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.15s ease;
}

.world-btn {
  display: inline-block;
  background: var(--neon-blue);
  color: #000000 !important;
  -webkit-text-fill-color: #000000;
  text-decoration: none;
  font-weight: 800;
  padding: 12px 24px;
  border-radius: 12px;
  text-transform: uppercase;
  letter-spacing: 1px;
}

.world-btn.top-right {
  position: absolute;
  top: 22px;
  right: 24px;
}

.map-error {
  color: #ff8b8b;
  text-align: center;
  padding: 30px;
  font-size: 1rem;
}

/* Back Button styles moved to #top-bar section */
/* Back Button styles moved to #top-bar section */
.back-btn svg {
  width: 24px;
  height: 24px;
  fill: currentColor;
}

/* Mobile Layout */
.mobile-list {
  display: none;
  flex-direction: column;
  gap: 12px;
  margin-top: 10px;
  width: 100%;
  max-width: 320px;
  margin-left: auto;
  margin-right: auto;
  padding-bottom: 20px;
}

.mobile-list .world-btn {
  text-align: center;
  width: 100%;
  display: block;
}

@media (max-width: 768px) {
  .landing-header {
    margin-bottom: 10px;
  }
  
  /* Hide Desktop "Entire World" button on mobile */
  /* Re-purposed to be the main button centered below header */
  .world-btn.top-right {
    display: block; /* Show it */
    position: static; /* Remove absolute positioning */
    margin: 10px auto 20px auto; /* Center it with spacing */
    width: fit-content;
    text-align: center;
    border: 1px solid rgba(255,255,255,0.2); /* Add subtle border for 'traditional' feel? Optional. */
  }

  /* FORCE Show Map (Globe) on index2.html mobile */
  /* Note: index.html might still need the hidden behavior for the flat map if we wanted to preserve it. 
     But for this task, we are enabling it. 
     If we want to target ONLY index2, we'd need a specific class on body. 
     Assuming this request overwrites the general "hide map on mobile" rule. */
  .map-stage {
    display: block;
    height: calc(100vh - 200px); /* Adjust height for button taking space */
    min-height: 400px;
  }

  /* Show List - Disable for now as we are doing 3D globe only */
  /* .mobile-list { display: flex; } */
  .mobile-list {
     display: none !important;
  }

  /* Adjust HUD and Back Button on mobile */
  /* Adjust HUD and Back Button on mobile */
  #top-bar {
    top: 20px; /* Reduced top spacing for mobile */
  }
  
  #top-hud {
    /* Mobile HUD adjustments */
    padding: 8px 20px;
    gap: 20px;
    width: 80%; /* Width constrained */
    justify-content: space-around;
  }
  .hud-group { min-width: auto; }
  .hud-item { font-size: 0.6rem; }
  .hud-val { font-size: 1rem; }
  
  .back-btn {
    /* Mobile back button */
    left: 10px;
    width: 36px;
    height: 36px;
    /* top/transform already handled by parent centering */
  }
  .back-btn svg { width: 18px; height: 18px; }
  
  /* Shift HUD slightly right to make room for back btn if needed, 
     but since HUD is centered and back btn is absolute left, 
     we just need to check overlap. */
  

/* Mobile Layout End */
}
