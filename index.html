<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>South America ISO Quiz</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
    <style>
        :root {
            --bg: #050505;
            --neon-blue: #00f3ff;
            --neon-green: #00ff9d;
            --glass: rgba(20, 20, 25, 0.9);
        }
        body { margin: 0; background: var(--bg); color: white; font-family: sans-serif; overflow: hidden; }
        #map-stage { width: 100vw; height: 100vh; }
        .country { fill: #222; stroke: #444; stroke-width: 1px; transition: 0.3s; cursor: pointer; }
        .country:hover { fill: #333; stroke: #888; }
        .correct { fill: var(--neon-green) !important; opacity: 0.6; }
        .wrong { fill: #ff0055 !important; }
        
        #ui { position: absolute; top: 20px; width: 100%; text-align: center; pointer-events: none; }
        .hud { background: var(--glass); display: inline-flex; gap: 20px; padding: 10px 30px; border-radius: 50px; pointer-events: auto; border: 1px solid #333; }
        #prompt { font-size: 2rem; font-weight: 900; margin-top: 20px; text-transform: uppercase; letter-spacing: 2px; }
        #sub { color: var(--neon-blue); margin-top: 5px; font-weight: bold; }
        .stat { display: flex; flex-direction: column; align-items: center; }
        .label { font-size: 0.7rem; opacity: 0.5; text-transform: uppercase; }
        .val { font-size: 1.2rem; font-weight: bold; color: var(--neon-blue); }
    </style>
</head>
<body>

<div id="ui">
    <div class="hud">
        <div class="stat"><span class="label">Target</span><span id="iso-display" class="val">--</span></div>
        <div class="stat"><span class="label">Score</span><span id="score-display" class="val">0</span></div>
    </div>
    <div id="prompt">Loading...</div>
    <div id="sub">Click the correct country</div>
</div>

<div id="map-stage"></div>

<script>
// Minimalist South America Geometry (Simplified for zero-fetch loading)
const saGeo = {
    type: "FeatureCollection",
    features: [
        { id: "ARG", properties: { name: "Argentina" }, geometry: { type: "Polygon", coordinates: [[[-65,-22],[-55,-30],[-58,-34],[-60,-50],[-70,-55],[-73,-40],[-65,-22]]] } },
        { id: "BRA", properties: { name: "Brazil" }, geometry: { type: "Polygon", coordinates: [[[-50,-2],[-35,-5],[-35,-15],[-50,-30],[-58,-20],[-70,-10],[-70,5],[-50,-2]]] } },
        { id: "CHL", properties: { name: "Chile" }, geometry: { type: "Polygon", coordinates: [[[-70,-18],[-68,-25],[-75,-55],[-70,-55],[-68,-20],[-70,-18]]] } },
        { id: "COL", properties: { name: "Colombia" }, geometry: { type: "Polygon", coordinates: [[[-75,12],[-70,5],[-70,0],[-78,2],[-75,12]]] } },
        { id: "PER", properties: { name: "Peru" }, geometry: { type: "Polygon", coordinates: [[[-80,-5],[-75,-15],[-70,-18],[-70,-10],[-80,-5]]] } },
        { id: "BOL", properties: { name: "Bolivia" }, geometry: { type: "Polygon", coordinates: [[[-70,-18],[-60,-20],[-58,-15],[-65,-10],[-70,-18]]] } },
        { id: "VEN", properties: { name: "Venezuela" }, geometry: { type: "Polygon", coordinates: [[[-72,11],[-60,10],[-60,2],[-67,2],[-72,11]]] } },
        { id: "PRY", properties: { name: "Paraguay" }, geometry: { type: "Polygon", coordinates: [[[-62,-20],[-55,-25],[-58,-30],[-62,-20]]] } },
        { id: "URY", properties: { name: "Uruguay" }, geometry: { type: "Polygon", coordinates: [[[-58,-34],[-53,-33],[-55,-30],[-58,-34]]] } },
        { id: "ECU", properties: { name: "Ecuador" }, geometry: { type: "Polygon", coordinates: [[[-80,-2],[-75,-2],[-78,2],[-80,-2]]] } },
        { id: "GUY", properties: { name: "Guyana" }, geometry: { type: "Polygon", coordinates: [[[-60,8],[-57,6],[-58,2],[-60,2],[-60,8]]] } },
        { id: "SUR", properties: { name: "Suriname" }, geometry: { type: "Polygon", coordinates: [[[-57,6],[-54,6],[-55,2],[-57,2],[-57,6]]] } }
    ]
};

const countries = ["ARG", "BRA", "CHL", "COL", "PER", "BOL", "VEN", "PRY", "URY", "ECU", "GUY", "SUR"];
let target = "";
let score = 0;

const width = window.innerWidth;
const height = window.innerHeight;

const svg = d3.select("#map-stage").append("svg")
    .attr("width", width)
    .attr("height", height);

const projection = d3.geoMercator()
    .center([-60, -25])
    .scale(width / 2.5)
    .translate([width / 2, height / 2]);

const path = d3.geoPath().projection(projection);

function init() {
    svg.selectAll("path")
        .data(saGeo.features)
        .enter().append("path")
        .attr("d", path)
        .attr("class", "country")
        .attr("id", d => d.id)
        .on("click", (e, d) => checkAnswer(d.id));

    newRound();
}

function newRound() {
    target = countries[Math.floor(Math.random() * countries.length)];
    document.getElementById("prompt").innerText = saGeo.features.find(f => f.id === target).properties.name;
    document.getElementById("iso-display").innerText = target;
    d3.selectAll(".country").classed("wrong", false);
}

function checkAnswer(id) {
    if (id === target) {
        score += 10;
        document.getElementById("score-display").innerText = score;
        d3.select(`#${id}`).classed("correct", true);
        setTimeout(() => {
            d3.select(`#${id}`).classed("correct", false);
            newRound();
        }, 500);
    } else {
        score -= 5;
        document.getElementById("score-display").innerText = score;
        d3.select(`#${id}`).classed("wrong", true);
        setTimeout(() => d3.select(`#${id}`).classed("wrong", false), 500);
    }
}

init();
</script>
</body>
</html>
